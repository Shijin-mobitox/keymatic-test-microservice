spring:
  config:
    import: "optional:configserver:"
  cloud:
    config:
      enabled: false
    gateway:
      routes:
        - id: tenant-service
          uri: http://tenant-service:8080
          predicates:
            - Path=/tenant/**
        - id: api-service
          uri: http://api-service:8080
          predicates:
            - Path=/api/**
        - id: auth-service
          uri: http://auth-service:8080
          predicates:
            - Path=/auth/**
  # OAuth2 Resource Server configuration for Keycloak JWT validation (reactive)
  security:
    oauth2:
      resourceserver:
        jwt:
          # Keycloak issuer URI - used to validate JWT tokens
          # The realm name should match your Keycloak realm configuration
          issuer-uri: http://keycloak:8080/realms/kymatic
          # JWK Set URI - used to fetch public keys for token validation
          # Spring Boot will auto-configure this from issuer-uri if not specified
          jwk-set-uri: http://keycloak:8080/realms/kymatic/protocol/openid-connect/certs

# Arconia multi-tenancy configuration
arconia:
  tenant:
    management:
      enabled: true
      # Arconia will use TenantContext to determine the current tenant
      # The tenant ID is extracted from JWT by ReactiveJwtTenantResolver filter

server:
  port: 8080

management:
  endpoints:
    web:
      exposure:
        include: health,info,mappings
  endpoint:
    health:
      show-details: always

logging:
  level:
    root: INFO
    com.kymatic: DEBUG
    org.springframework.security: DEBUG
