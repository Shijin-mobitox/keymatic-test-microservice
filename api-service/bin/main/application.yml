spring:
  config:
    import: "optional:configserver:"
  cloud:
    config:
      enabled: false
  datasource:
    url: ${SPRING_DATASOURCE_URL:jdbc:postgresql://localhost:5432/postgres}
    username: ${SPRING_DATASOURCE_USERNAME:postgres}
    password: ${SPRING_DATASOURCE_PASSWORD:root}
    driver-class-name: org.postgresql.Driver
  jpa:
    hibernate:
      ddl-auto: none
    open-in-view: false
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
  flyway:
    enabled: true
    locations: classpath:db/migration
    baseline-on-migrate: true
    schemas: public
    validate-on-migrate: false
  # OAuth2 Resource Server configuration for Keycloak JWT validation
  security:
    oauth2:
      resourceserver:
        jwt:
          # Keycloak issuer URI - used to validate JWT tokens
          # The realm name should match your Keycloak realm configuration
          issuer-uri: http://keycloak:8080/realms/kymatic
          # JWK Set URI - used to fetch public keys for token validation
          # Spring Boot will auto-configure this from issuer-uri if not specified
          jwk-set-uri: http://keycloak:8080/realms/kymatic/protocol/openid-connect/certs

# Arconia multi-tenancy configuration
arconia:
  tenant:
    management:
      enabled: true
      # Arconia will use TenantContext to determine the current tenant
      # The tenant ID is extracted from JWT by TenantResolver filter

server:
  port: 8080

management:
  endpoints:
    web:
      exposure:
        include: health,info,mappings
  endpoint:
    health:
      show-details: always

logging:
  level:
    root: INFO
    com.kymatic: DEBUG
    org.springframework.security: DEBUG
